(()=>{"use strict";var e={730:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSettings=void 0;const n=o(131),i=o(451),s=o(374),a=o(936),d=o(923),r=o(287);t.addSettings=()=>{if(!l("menu")?.childNodes?.length)return;if("prefs"!==Game.onMenu)return;const e=document.createElement("div");e.id="ACSettings",e.className="subsection";const t=document.createElement("div");t.className="title",t.innerHTML="Any Cookie Settings";const o=document.createElement("div");o.className="listing";const c=document.createElement("a");c.id="switchButton",c.classList.add("smallFancyButton","option"),c.innerHTML="Get image from: "+(i.settings.isFromFile?"file":"link");const p=(0,s.createFileUploader)(),g=(0,a.createLinkUploader)();(0,d.handleUploadesrToggle)(p,g),c.onclick=()=>{i.settings.isFromFile=!i.settings.isFromFile,(0,d.handleUploadesrToggle)(p,g),(0,n.updateBigCookie)(),c.innerHTML="Get image from: "+(i.settings.isFromFile?"file":"link"),PlaySound("snd/tick.mp3")};const m=document.createElement("label");m.innerHTML="(note: file uploaded images is stored in your browser (localstorage), not in the game's save file!)",o.appendChild(c),o.appendChild(m),o.appendChild(document.createElement("br")),o.appendChild(p),o.appendChild(g),o.appendChild(document.createElement("br"));const u=(0,r.createSettingsOptions)("roundImage","Round image",(()=>{const e=l("fileUploadCircleCover");e&&(e.style.display=i.settings.roundImage?"block":"none")}));o.appendChild(u),o.appendChild(document.createElement("br"));const y=(0,r.createSettingsOptions)("saveProportions","Save proportions",(()=>{const e=l("fileUploadPreview");e&&(e.style.objectFit=i.settings.saveProportions?"contain":"fill")}));o.appendChild(y),o.appendChild(document.createElement("br"));const h=(0,r.createSettingsOptions)("dropShadow","Drop shadow");o.appendChild(h);const f=document.createElement("a");f.id="resetButton",f.classList.add("smallFancyButton","option","warning"),f.innerHTML="Reset to default",f.onclick=()=>{i.settings.isFromFile=!1,i.settings.url="",i.settings.roundImage=!1,localStorage.setItem("anyCookieImage",""),(0,d.handleUploadesrToggle)(p,g),(0,n.updateBigCookie)(),Game.Notify("All image data removed!","Here we go again",[10,0]),PlaySound("snd/tick.mp3")},o.appendChild(document.createElement("br")),o.appendChild(f),e.appendChild(t),e.appendChild(o),l("menu")?.insertBefore(e,l("menu")?.childNodes[3]||null)}},113:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applySettings=void 0;const n=o(923),i=o(131);t.applySettings=()=>{(0,i.updateBigCookie)();const e=l("ACfileUploader"),t=l("AClinkUploader");e&&t&&(0,n.handleUploadesrToggle)(e,t)}},923:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleUploadesrToggle=t.handleSetImage=void 0;const n=o(451),i=o(131);t.handleSetImage=(e,t)=>{const o=t?localStorage.getItem("anyCookieImage"):n.settings.url;PlaySound("snd/tick.mp3"),o!==e&&(n.settings.isFromFile=t,t?localStorage.setItem("anyCookieImage",e):n.settings.url=e,(0,i.updateBigCookie)())},t.handleUploadesrToggle=(e,t)=>{e.style.display=n.settings.isFromFile?"flex":"none",t.style.display=n.settings.isFromFile?"none":"block"}},131:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateBigCookie=void 0;const n=o(451);t.updateBigCookie=e=>{const t=localStorage.getItem("anyCookieImage")||"",o=n.settings.isFromFile?t:n.settings.url;if(!o)return Game.Loader.Replace("perfectCookie.png","perfectCookie.png"),Game.Loader.Replace("cookieShadow.png","cookieShadow.png"),void(n.settings.isDefaultImage=!0);const i=n.settings.roundImage,s=new Image;let l=document.createElement("canvas"),a=l.getContext("2d");s.src=o,s.setAttribute("crossorigin","anonymous"),s.onerror=e=>{Game.Notify("Image is blocked from this URL!","Try downloading it as a file",[15,5])},s.onload=()=>{if(l.width=s.width,l.height=s.width,!a)return;if(i){const e=s.width;a.beginPath(),a.arc(e/2,e/2,e/2,0,2*Math.PI,!0),a.closePath(),a.clip()}if(n.settings.saveProportions){const e=Math.max(s.width,s.height)/s.width,t=s.width/e,o=s.height/e,n=(l.width-t)/2,i=(l.height-o)/2;a.drawImage(s,n,i,l.width-2*n,l.width-2*i)}else{const e=s.width;s.height=e,a.drawImage(s,0,0,e,e)}const t=new Image;t.src=l.toDataURL(),l=document.createElement("canvas"),a=l.getContext("2d"),t.width=s.width,t.height=s.width,t.onload=()=>{const o=s.width;l.width=o,l.height=o,a&&(n.settings.dropShadow?(a.shadowColor="black",a.shadowBlur=15,a.shadowOffsetY=10,a.drawImage(t,15,15,o-30,o-30)):a.drawImage(t,0,0,o,o),Game.Loader.Replace("perfectCookie.png",l.toDataURL()),Game.Loader.Replace("cookieShadow.png","filler.png"),n.settings.isDefaultImage=!1,e&&Game.Notify("New image set!","Looks wonderful!",[25,7]))}}}},451:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.settings=void 0,t.settings={isFromFile:!1,url:"",roundImage:!1,isDefaultImage:!0,saveProportions:!0,dropShadow:!0}},374:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createFileUploader=void 0;const n=o(923),i=o(131),s=o(451);t.createFileUploader=()=>{const e=localStorage.getItem("anyCookieImage"),t=document.createElement("a");t.classList.add("smallFancyButton","option"),t.style.height="138px",t.style.position="relative",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.id="ACfileUploader";const o=document.createElement("div");o.style.position="absolute",o.style.display=e?"none":"block",o.innerHTML="Choose file";const l=document.createElement("img");l.id="fileUploadPreview",l.style.width="100%",l.style.height="100%",l.style.position="absolute",l.style.zIndex="8",l.style.display=e?"block":"none",l.style.objectFit=s.settings.saveProportions?"contain":"fill",l.src=e||"";const a=document.createElement("div");a.id="fileUploadCircleCover",a.style.position="absolute",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.zIndex="9",a.style.backgroundColor="rgba(0, 0, 0, 0.8)",a.style.mixBlendMode="hard-light",a.style.display=s.settings.roundImage?"block":"none";const d=document.createElement("div");d.style.position="absolute",d.style.top="0",d.style.left="0",d.style.width="100%",d.style.height="100%",d.style.zIndex="10",d.style.backgroundColor="gray",d.style.borderRadius="50%";const r=document.createElement("div");r.style.position="absolute",r.style.top="10px",r.style.right="10px",r.style.zIndex="11",r.style.cursor="pointer",r.style.display=e?"block":"none",r.innerHTML="Clear";const c=document.createElement("input");return c.type="file",c.style.width="100%",c.style.height="100%",c.style.opacity="0",c.style.position="absolute",c.style.cursor="pointer",c.style.zIndex="10",c.id="ACfileInput",c.onchange=e=>{const t=e.target,i=t?.files?.[0],s=new FileReader;i&&(s.readAsDataURL(i),s.onload=()=>{(0,n.handleSetImage)(s.result,!0),l.src=s.result,l.style.display="block",r.style.display="block",o.style.display="none"})},r.onclick=()=>{localStorage.setItem("anyCookieImage",""),l.src="",l.style.display="none",r.style.display="none",o.style.display="block",(0,i.updateBigCookie)(),PlaySound("snd/tick.mp3"),Game.Notify("Image removed!","Here we go again",[10,0])},t.appendChild(c),t.appendChild(l),t.appendChild(r),t.appendChild(o),t.appendChild(a),a.appendChild(d),t}},936:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLinkUploader=void 0;const n=o(451),i=o(923),s=o(131);t.createLinkUploader=()=>{const e=document.createElement("div");e.id="AClinkUploader",e.style.display="flex",e.style.alignItems="center";const t=document.createElement("input");t.type="text",t.id="AClinkInput",t.style.userSelect="all",t.style.width="300px",t.placeholder="https://example.com",t.value=n.settings.url;const o=document.createElement("a");o.id="ACapplyButton",o.classList.add("smallFancyButton","option"),o.style.width="30px",o.innerHTML="Apply";const l=document.createElement("a");l.id="ACclearButton",l.classList.add("smallFancyButton","option"),l.style.width="30px",l.innerHTML="Clear";const a=()=>{n.settings.url="",t.value="",PlaySound("snd/tick.mp3"),n.settings.isDefaultImage||((0,s.updateBigCookie)(),Game.Notify("Image removed!","Here we go again",[10,0]))};return o.onclick=()=>{t.value?(0,i.handleSetImage)(t.value,!1):a()},l.onclick=a,e.appendChild(t),e.appendChild(o),e.appendChild(l),e}},287:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSettingsOptions=void 0;const n=o(131),i=o(451);t.createSettingsOptions=(e,t,o)=>{const s=document.createElement("a");return s.id=`${e}SettingOption`,s.classList.add("smallFancyButton","option","prefButton"),s.classList.toggle("off",!i.settings[e]),s.innerHTML=`${t} (${i.settings[e]?"ON":"OFF"})`,s.onclick=()=>{i.settings[e]=!i.settings[e],(0,n.updateBigCookie)(),s.innerHTML=`${t} (${i.settings[e]?"ON":"OFF"})`,s.classList.toggle("off",!i.settings[e]),o?.(),PlaySound("snd/tick.mp3")},s}}},t={};function o(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,o),s.exports}(()=>{const e=o(730),t=o(113),n=o(451),i={init:()=>{const t=Game.UpdateMenu;Game.UpdateMenu=()=>{t(),(0,e.addSettings)()}},save:()=>JSON.stringify(n.settings),load:e=>{const o=JSON.parse(e);Object.keys(o).forEach((e=>{n.settings[e]=o[e]})),(0,t.applySettings)()}};"undefined"!=typeof Steam?setTimeout((function(){Game.registerMod("AnyCookie",i)}),2e3):Game.registerMod("AnyCookie",i)})()})();
//# sourceMappingURL=AnyCookie.js.map