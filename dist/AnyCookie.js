(()=>{"use strict";var e={730:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addSettings=void 0;const n=i(131),o=i(451),a=i(374),s=i(936),d=i(923),r=i(287);t.addSettings=()=>{if(!l("menu")?.childNodes?.length)return;if("prefs"!==Game.onMenu)return;const e=document.createElement("div");e.id="ACSettings",e.className="subsection";const t=document.createElement("div");t.className="title",t.innerHTML="Any Cookie Settings";const i=document.createElement("div");i.className="listing";const c=document.createElement("a");c.id="switchButton",c.classList.add("smallFancyButton","option"),c.innerHTML="Get image from: "+(o.settings.isFromFile?"file":"link");const p=(0,a.createFileUploader)(),g=(0,s.createLinkUploader)();(0,d.handleUploadesrToggle)(p,g),c.onclick=()=>{o.settings.isFromFile=!o.settings.isFromFile,(0,d.handleUploadesrToggle)(p,g),(0,n.updateBigCookie)(),c.innerHTML="Get image from: "+(o.settings.isFromFile?"file":"link"),PlaySound("snd/tick.mp3")};const m=document.createElement("label");m.innerHTML="(note: file uploaded images is stored in your browser (localstorage), not in the game's save file!)",i.appendChild(c),i.appendChild(m),i.appendChild(document.createElement("br")),i.appendChild(p),i.appendChild(g),i.appendChild(document.createElement("br"));const u=(0,r.createSettingsOptions)("roundImage","Round image",(()=>{const e=l("fileUploadCircleCover");e&&(e.style.display=o.settings.roundImage?"block":"none")}));i.appendChild(u),i.appendChild(document.createElement("br"));const h=document.createElement("a");h.id="imageFitSettingOption",h.classList.add("smallFancyButton","option"),h.innerHTML=`Image fit: ${o.settings.imageFit.toUpperCase()}`,h.onclick=()=>{const e=o.imageFitVariants.indexOf(o.settings.imageFit);o.settings.imageFit=o.imageFitVariants[(e+1)%o.imageFitVariants.length],(0,n.updateBigCookie)(),h.innerHTML=`Image fit: ${o.settings.imageFit.toUpperCase()}`,y.innerHTML=o.imageFitDescriptions[o.imageFitVariants.indexOf(o.settings.imageFit)],PlaySound("snd/tick.mp3")};const y=document.createElement("label");y.innerHTML=o.imageFitDescriptions[o.imageFitVariants.indexOf(o.settings.imageFit)],i.appendChild(h),i.appendChild(y),i.appendChild(document.createElement("br"));const f=(0,r.createSettingsOptions)("dropShadow","Drop shadow");i.appendChild(f);const C=document.createElement("a");C.id="resetButton",C.classList.add("smallFancyButton","option","warning"),C.innerHTML="Reset to default",C.onclick=()=>{o.settings.isFromFile=!1,o.settings.url="",o.settings.roundImage=!1,localStorage.setItem("anyCookieImage",""),(0,d.handleUploadesrToggle)(p,g),(0,n.updateBigCookie)(),Game.Notify("All image data removed!","Here we go again",[10,0]),PlaySound("snd/tick.mp3")},i.appendChild(document.createElement("br")),i.appendChild(C),e.appendChild(t),e.appendChild(i),l("menu")?.insertBefore(e,l("menu")?.childNodes[3]||null)}},113:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.applySettings=void 0;const n=i(923),o=i(131);t.applySettings=()=>{(0,o.updateBigCookie)();const e=l("ACfileUploader"),t=l("AClinkUploader");e&&t&&(0,n.handleUploadesrToggle)(e,t)}},923:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.handleUploadesrToggle=t.handleSetImage=void 0;const n=i(451),o=i(131);t.handleSetImage=(e,t)=>{const i=t?localStorage.getItem("anyCookieImage"):n.settings.url;PlaySound("snd/tick.mp3"),i!==e&&(n.settings.isFromFile=t,t?localStorage.setItem("anyCookieImage",e):n.settings.url=e,(0,o.updateBigCookie)())},t.handleUploadesrToggle=(e,t)=>{e.style.display=n.settings.isFromFile?"flex":"none",t.style.display=n.settings.isFromFile?"none":"block"}},131:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateBigCookie=void 0;const n=i(451);t.updateBigCookie=e=>{const t=localStorage.getItem("anyCookieImage")||"",i=n.settings.isFromFile?t:n.settings.url;if(!i)return Game.Loader.Replace("perfectCookie.png","perfectCookie.png"),Game.Loader.Replace("cookieShadow.png","cookieShadow.png"),void(n.settings.isDefaultImage=!0);const o=n.settings.roundImage,a=new Image;let s=document.createElement("canvas"),l=s.getContext("2d");a.src=i,a.setAttribute("crossorigin","anonymous"),a.onerror=e=>{Game.Notify("Image is blocked from this URL!","Try downloading it as a file",[15,5])},a.onload=()=>{if(s.width=a.width,s.height=a.width,!l)return;if(o){const e=a.width;l.beginPath(),l.arc(e/2,e/2,e/2,0,2*Math.PI,!0),l.closePath(),l.clip()}if("fill"===n.settings.imageFit){const e=a.width;a.height=e,l.drawImage(a,0,0,e,e)}else{const e=Math.max(a.width,a.height),t=Math.min(a.width,a.height),i=("contain"===n.settings.imageFit?e:t)/a.width,o=a.width/i,d=a.height/i,r=(s.width-o)/2,c=(s.height-d)/2;l.drawImage(a,r,c,s.width-2*r,s.width-2*c)}const t=new Image;t.src=s.toDataURL(),s=document.createElement("canvas"),l=s.getContext("2d"),t.width=a.width,t.height=a.width,t.onload=()=>{const i=a.width;s.width=i,s.height=i,l&&(n.settings.dropShadow?(l.shadowColor="black",l.shadowBlur=15,l.shadowOffsetY=10,l.drawImage(t,15,15,i-30,i-30)):l.drawImage(t,0,0,i,i),Game.Loader.Replace("perfectCookie.png",s.toDataURL()),Game.Loader.Replace("cookieShadow.png","filler.png"),n.settings.isDefaultImage=!1,e&&Game.Notify("New image set!","Looks wonderful!",[25,7]))}}}},451:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.settings=t.imageFitDescriptions=t.imageFitVariants=void 0,t.imageFitVariants=["contain","cover","fill"],t.imageFitDescriptions=["(contain: changes width and height to make sure image fits inside, saving proportions)","(cover: changes width and height to fill all space, saving proportions)","(fill: changes width and height to fill all space, not saving proportions)"],t.settings={isFromFile:!1,url:"",roundImage:!1,isDefaultImage:!0,imageFit:"contain",dropShadow:!0}},374:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createFileUploader=void 0;const n=i(923),o=i(131),a=i(451);t.createFileUploader=()=>{const e=localStorage.getItem("anyCookieImage"),t=document.createElement("div");t.style.position="relative",t.style.width="185px",t.style.display="flex",t.style.flexDirection="column";const i=document.createElement("a");i.classList.add("smallFancyButton","option"),i.style.height="138px",i.style.position="relative",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.id="ACfileUploader";const s=document.createElement("div");s.style.position="absolute",s.style.display=e?"none":"block",s.innerHTML="Choose file";const l=document.createElement("img");l.id="fileUploadPreview",l.style.width="100%",l.style.height="100%",l.style.position="absolute",l.style.zIndex="8",l.style.display=e?"block":"none",l.style.objectFit=a.settings.imageFit,l.src=e||"";const d=document.createElement("div");d.id="fileUploadCircleCover",d.style.position="absolute",d.style.top="0",d.style.left="0",d.style.width="100%",d.style.height="100%",d.style.zIndex="9",d.style.backgroundColor="rgba(0, 0, 0, 0.8)",d.style.mixBlendMode="hard-light",d.style.display=a.settings.roundImage?"block":"none";const r=document.createElement("div");r.style.position="absolute",r.style.top="0",r.style.left="0",r.style.width="100%",r.style.height="100%",r.style.zIndex="10",r.style.backgroundColor="gray",r.style.borderRadius="50%";const c=document.createElement("div");c.style.position="absolute",c.style.top="10px",c.style.right="10px",c.style.zIndex="11",c.style.cursor="pointer",c.style.display=e?"block":"none",c.innerHTML="Clear";const p=document.createElement("input");p.type="file",p.style.width="100%",p.style.height="100%",p.style.opacity="0",p.style.position="absolute",p.style.cursor="pointer",p.style.zIndex="10",p.id="ACfileInput";const g=document.createElement("label");return g.style.padding="2px 0",g.innerHTML="(file update can take up to 5 seconds)",p.onchange=e=>{const t=e.target,i=t?.files?.[0],o=new FileReader;i&&(o.readAsDataURL(i),o.onload=()=>{(0,n.handleSetImage)(o.result,!0),l.src=o.result,l.style.display="block",c.style.display="block",s.style.display="none"})},c.onclick=()=>{localStorage.setItem("anyCookieImage",""),l.src="",l.style.display="none",c.style.display="none",s.style.display="block",(0,o.updateBigCookie)(),PlaySound("snd/tick.mp3"),Game.Notify("Image removed!","Here we go again",[10,0])},d.appendChild(r),i.appendChild(p),i.appendChild(l),i.appendChild(c),i.appendChild(s),i.appendChild(d),t.appendChild(i),t.appendChild(g),t}},936:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLinkUploader=void 0;const n=i(451),o=i(923),a=i(131);t.createLinkUploader=()=>{const e=document.createElement("div");e.id="AClinkUploader",e.style.display="flex",e.style.alignItems="center";const t=document.createElement("input");t.type="text",t.id="AClinkInput",t.style.userSelect="all",t.style.width="300px",t.placeholder="https://example.com",t.value=n.settings.url;const i=document.createElement("a");i.id="ACapplyButton",i.classList.add("smallFancyButton","option"),i.style.width="30px",i.innerHTML="Apply";const s=document.createElement("a");s.id="ACclearButton",s.classList.add("smallFancyButton","option"),s.style.width="30px",s.innerHTML="Clear";const l=()=>{n.settings.url="",t.value="",PlaySound("snd/tick.mp3"),n.settings.isDefaultImage||((0,a.updateBigCookie)(),Game.Notify("Image removed!","Here we go again",[10,0]))};return i.onclick=()=>{t.value?(0,o.handleSetImage)(t.value,!1):l()},s.onclick=l,e.appendChild(t),e.appendChild(i),e.appendChild(s),e}},287:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createSettingsOptions=void 0;const n=i(131),o=i(451);t.createSettingsOptions=(e,t,i)=>{const a=document.createElement("a");return a.id=`${e}SettingOption`,a.classList.add("smallFancyButton","option","prefButton"),a.classList.toggle("off",!o.settings[e]),a.innerHTML=`${t} (${o.settings[e]?"ON":"OFF"})`,a.onclick=()=>{o.settings[e]=!o.settings[e],(0,n.updateBigCookie)(),a.innerHTML=`${t} (${o.settings[e]?"ON":"OFF"})`,a.classList.toggle("off",!o.settings[e]),i?.(),PlaySound("snd/tick.mp3")},a}}},t={};function i(n){var o=t[n];if(void 0!==o)return o.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,i),a.exports}(()=>{const e=i(730),t=i(113),n=i(451),o={init:()=>{const t=Game.UpdateMenu;Game.UpdateMenu=()=>{t(),(0,e.addSettings)()}},save:()=>JSON.stringify(n.settings),load:e=>{const i=JSON.parse(e);Object.keys(i).forEach((e=>{n.settings[e]=i[e]})),(0,t.applySettings)()}};"undefined"!=typeof Steam?setTimeout((function(){Game.registerMod("AnyCookie",o)}),2e3):Game.registerMod("AnyCookie",o)})()})();
//# sourceMappingURL=AnyCookie.js.map